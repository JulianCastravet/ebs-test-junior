{"ast":null,"code":"var _jsxFileName = \"/home/brizy/Documents/MyApp/test/ebs-fe-test/src/context.tsx\";\nimport React, { createContext, useEffect, useState } from 'react';\nconst prodConstVal = {\n  products: [],\n  cartItems: [],\n  fetchProducts: () => {},\n  addToCart: () => {},\n  removeFromCart: () => {}\n};\nexport const ProductContext = createContext(prodConstVal);\nexport const ProductsProvider = _ref => {\n  let {\n    children\n  } = _ref;\n  const [products, setProducts] = useState([]);\n  const [items, setItems] = useState(prodConstVal.cartItems);\n  useEffect(() => {\n    fetch('http://localhost:3001/api/products/').then(data => data.json()).then(res => {\n      setProducts(res);\n    });\n  }, []);\n\n  const fetchProducts = () => {\n    return products;\n  };\n\n  const addToCart = newItem => {\n    setItems(prev => {\n      const foundItem = prev.find(el => el.id === newItem.id);\n\n      if (foundItem) {\n        return prev.map(el => el.id === newItem.id ? { ...el,\n          quantity: el.quantity + 1\n        } : el);\n      } else {\n        return [...prev, newItem];\n      }\n    });\n  };\n\n  const removeFromCart = productId => {\n    setItems(prev => prev.reduce((ack, item) => {\n      if (item.id === productId) {\n        if (item.quantity === 1) return ack;\n        return [...ack, { ...item,\n          quantity: item.quantity - 1\n        }];\n      } else {\n        return [...ack, item];\n      }\n    }, []));\n  };\n\n  console.log(items, 'itemssss');\n  return /*#__PURE__*/React.createElement(ProductContext.Provider, {\n    value: {\n      addToCart,\n      cartItems: items,\n      products,\n      removeFromCart,\n      fetchProducts\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }\n  }, children);\n};\nexport const ProductConsumer = () => {\n  return /*#__PURE__*/React.createElement(ProductContext.Consumer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 10\n    }\n  }, value);\n};","map":{"version":3,"names":["React","createContext","useEffect","useState","prodConstVal","products","cartItems","fetchProducts","addToCart","removeFromCart","ProductContext","ProductsProvider","children","setProducts","items","setItems","fetch","then","data","json","res","newItem","prev","foundItem","find","el","id","map","quantity","productId","reduce","ack","item","console","log","ProductConsumer","value"],"sources":["/home/brizy/Documents/MyApp/test/ebs-fe-test/src/context.tsx"],"sourcesContent":["import { ProductContextType, Product, CartItem } from 'interfaces';\nimport React, { createContext, FC,useEffect, useState } from 'react';\nimport { Cart } from 'components/Cart';\n\nconst prodConstVal: ProductContextType = {\n  products: [],\n  cartItems: [],\n  fetchProducts: () => {},\n  addToCart: () => {},\n  removeFromCart: () => {},\n};\n\nexport const ProductContext = createContext<ProductContextType>(prodConstVal);\n\nexport const ProductsProvider: FC = ({ children }) => {\n  const [products, setProducts] = useState<Product[]>([]);\n  const [items, setItems] = useState<CartItem[]>(prodConstVal.cartItems);\n\n  useEffect(() => {\n    fetch('http://localhost:3001/api/products/')\n      .then((data) => data.json())\n      .then((res: Product[]) => {\n        setProducts(res);\n      });\n  }, []);\n\n  const fetchProducts = () => {\n    return products;\n  };\n\n  const addToCart = (newItem: CartItem) => {\n    setItems((prev) => {\n      const foundItem = prev.find((el) => el.id === newItem.id);\n      if (foundItem) {\n        return prev.map((el) => (el.id === newItem.id ? { ...el, quantity: el.quantity + 1 } : el));\n      } else {\n        return [...prev, newItem];\n      }\n    });\n  };\n\n  const removeFromCart = (productId: number) => {\n    setItems((prev) =>\n      prev.reduce((ack, item) => {\n        if (item.id === productId) {\n          if (item.quantity === 1) return ack;\n          return [...ack, { ...item, quantity: item.quantity - 1 }];\n        } else {\n          return [...ack, item];\n        }\n      }, [] as CartItem[]),\n    );\n  };\n  console.log(items, 'itemssss');\n  return (\n    <ProductContext.Provider value={{ addToCart, cartItems: items, products, removeFromCart, fetchProducts }}>\n      {children}\n    </ProductContext.Provider>\n  );\n};\n\nexport const ProductConsumer = () => {\n  return <ProductContext.Consumer >{value}</ProductContext.Consumer>;\n};\n"],"mappings":";AACA,OAAOA,KAAP,IAAgBC,aAAhB,EAAkCC,SAAlC,EAA6CC,QAA7C,QAA6D,OAA7D;AAGA,MAAMC,YAAgC,GAAG;EACvCC,QAAQ,EAAE,EAD6B;EAEvCC,SAAS,EAAE,EAF4B;EAGvCC,aAAa,EAAE,MAAM,CAAE,CAHgB;EAIvCC,SAAS,EAAE,MAAM,CAAE,CAJoB;EAKvCC,cAAc,EAAE,MAAM,CAAE;AALe,CAAzC;AAQA,OAAO,MAAMC,cAAc,GAAGT,aAAa,CAAqBG,YAArB,CAApC;AAEP,OAAO,MAAMO,gBAAoB,GAAG,QAAkB;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EACpD,MAAM,CAACP,QAAD,EAAWQ,WAAX,IAA0BV,QAAQ,CAAY,EAAZ,CAAxC;EACA,MAAM,CAACW,KAAD,EAAQC,QAAR,IAAoBZ,QAAQ,CAAaC,YAAY,CAACE,SAA1B,CAAlC;EAEAJ,SAAS,CAAC,MAAM;IACdc,KAAK,CAAC,qCAAD,CAAL,CACGC,IADH,CACSC,IAAD,IAAUA,IAAI,CAACC,IAAL,EADlB,EAEGF,IAFH,CAESG,GAAD,IAAoB;MACxBP,WAAW,CAACO,GAAD,CAAX;IACD,CAJH;EAKD,CANQ,EAMN,EANM,CAAT;;EAQA,MAAMb,aAAa,GAAG,MAAM;IAC1B,OAAOF,QAAP;EACD,CAFD;;EAIA,MAAMG,SAAS,GAAIa,OAAD,IAAuB;IACvCN,QAAQ,CAAEO,IAAD,IAAU;MACjB,MAAMC,SAAS,GAAGD,IAAI,CAACE,IAAL,CAAWC,EAAD,IAAQA,EAAE,CAACC,EAAH,KAAUL,OAAO,CAACK,EAApC,CAAlB;;MACA,IAAIH,SAAJ,EAAe;QACb,OAAOD,IAAI,CAACK,GAAL,CAAUF,EAAD,IAASA,EAAE,CAACC,EAAH,KAAUL,OAAO,CAACK,EAAlB,GAAuB,EAAE,GAAGD,EAAL;UAASG,QAAQ,EAAEH,EAAE,CAACG,QAAH,GAAc;QAAjC,CAAvB,GAA8DH,EAAhF,CAAP;MACD,CAFD,MAEO;QACL,OAAO,CAAC,GAAGH,IAAJ,EAAUD,OAAV,CAAP;MACD;IACF,CAPO,CAAR;EAQD,CATD;;EAWA,MAAMZ,cAAc,GAAIoB,SAAD,IAAuB;IAC5Cd,QAAQ,CAAEO,IAAD,IACPA,IAAI,CAACQ,MAAL,CAAY,CAACC,GAAD,EAAMC,IAAN,KAAe;MACzB,IAAIA,IAAI,CAACN,EAAL,KAAYG,SAAhB,EAA2B;QACzB,IAAIG,IAAI,CAACJ,QAAL,KAAkB,CAAtB,EAAyB,OAAOG,GAAP;QACzB,OAAO,CAAC,GAAGA,GAAJ,EAAS,EAAE,GAAGC,IAAL;UAAWJ,QAAQ,EAAEI,IAAI,CAACJ,QAAL,GAAgB;QAArC,CAAT,CAAP;MACD,CAHD,MAGO;QACL,OAAO,CAAC,GAAGG,GAAJ,EAASC,IAAT,CAAP;MACD;IACF,CAPD,EAOG,EAPH,CADM,CAAR;EAUD,CAXD;;EAYAC,OAAO,CAACC,GAAR,CAAYpB,KAAZ,EAAmB,UAAnB;EACA,oBACE,oBAAC,cAAD,CAAgB,QAAhB;IAAyB,KAAK,EAAE;MAAEN,SAAF;MAAaF,SAAS,EAAEQ,KAAxB;MAA+BT,QAA/B;MAAyCI,cAAzC;MAAyDF;IAAzD,CAAhC;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,GACGK,QADH,CADF;AAKD,CA7CM;AA+CP,OAAO,MAAMuB,eAAe,GAAG,MAAM;EACnC,oBAAO,oBAAC,cAAD,CAAgB,QAAhB;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,GAA2BC,KAA3B,CAAP;AACD,CAFM"},"metadata":{},"sourceType":"module"}